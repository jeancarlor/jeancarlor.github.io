[{"content":"\u003cp\u003eThe main consideration is to make sure that the reference resource matches the genomic build of your VCF. i.e. make sure you are using GRCh37 resources for a GRCh37 aligned VCF, or GRCh38 resources for a GRCh38 aligned VCF.\u003c/p\u003e\n\u003ch2 id=\"dbsnp\"\u003edbSNP\u003c/h2\u003e\n\u003cp\u003eA vcf from dbSNP can be used to annotate rsIDs into the ID column of a vcf. For instance the dbSNP v151 VCF can be downloaded here \u003ca href=\"ftp://ftp.ncbi.nih.gov/snp/organisms/human_9606_b151_GRCh37p13/VCF/\"\u003eftp://ftp.ncbi.nih.gov/snp/organisms/human_9606_b151_GRCh37p13/VCF/\u003c/a\u003e - one key thing is make sure that you use the same genome build as your VCF that you want to annotate.\u003c/p\u003e\n\u003cp\u003eOnce you have a copy (Merrimanlab can find it in \u003ccode\u003e/Volumes/archive/merrimanlab/reference_files/VCF/dbSNP_reference/dbsnp151_GRCh37/dbsnp_151_20180423.vcf.gz\u003c/code\u003e)\u003c/p\u003e\n\u003cp\u003eThen to annotate using bcftools\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# use on the server\nmodule load bcftools/bcftools-1.11\n\nbcftools annotate -a dbsnp_151_20180423.vcf.gz -c ID -o myvcf.dbsnp_annotated.vcf.gz -O z myvcf.vcf.gz\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"dbnsfp\"\u003edbNSFP\u003c/h2\u003e\n\u003ch3 id=\"creation-of-latest-dbnsfp\"\u003eCreation of latest dbNSFP\u003c/h3\u003e\n\u003cp\u003e\u003ca href=\"https://sites.google.com/site/jpopgen/dbNSFP\"\u003ehttps://sites.google.com/site/jpopgen/dbNSFP\u003c/a\u003e\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ewget ftp://dbnsfp:dbnsfp@dbnsfp.softgenetics.com/dbNSFP4.0a.zip\nunzip dbNSFP4.0a.zip\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe file has GRCh38 coordinates as the default, so to change them you need this perl script \u003ca href=\"https://raw.githubusercontent.com/pcingola/SnpEff/master/scripts_build/dbNSFP_sort.pl\"\u003edbNSFP_sort.pl\u003c/a\u003e and the GRCh37 coordinates are columns 8 and 9, but the script is zero indexed hence using 7 and 8 as the column numbers.\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e# Set to your downloaded dbNSFP version\nversion=\u0026#34;4.0a\u0026#34;\n\n# Replace coordinates by columns 7 and 8 (hg19 coordinates) and sort by those coordinates\nzcat dbNSFP${version}_variant.chr*.gz | dbNSFP_sort.pl 7 8 \u0026gt; dbNSFP4.0a_hg19.txt\n\n# Compress and index\nbgzip dbNSFP${version}_hg19.txt\ntabix -s 1 -b 2 -e 2 dbNSFP${version}_hg19.txt.gz\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOnce this annotation file is created it can be used to annotate VCF files using \u003ccode\u003eSnpSift\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eFor Merrimanlab, a version is available at \u003ccode\u003e/Volumes/archive/merrimanlab/reference_files/dbNSFP/dbNSFP4.0a/dbNSFP4.0a_hg19.txt.gz\u003c/code\u003e\u003c/p\u003e\n\u003ch3 id=\"annotate\"\u003eAnnotate\u003c/h3\u003e\n\u003cp\u003eMake sure to check out the readme that came with dbNSFP for an idea of the annotations that are available (\u003ccode\u003e/Volumes/archive/merrimanlab/reference_files/dbNSFP/dbNSFP4.0a/dbNSFP4.0a.readme.txt\u003c/code\u003e).\u003c/p\u003e\n\u003cp\u003eTo perform the annotation, we use \u003ccode\u003eSnpSift\u003c/code\u003e which comes as part of \u003ccode\u003esnpEff\u003c/code\u003e.\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emodule load snpEff/snpEff_4.3t\n\njava -jar $SNPSIFT dbnsfp -db dbNSFP4.0a_hg19.txt.gz -f $(zcat /Volumes/archive/merrimanlab/reference_files/dbNSFP/dbNSFP4.0a/dbNSFP4.0a_hg19.txt.gz | head -1 | tr \u0026#34;\\t\u0026#34; \u0026#34;\\n\u0026#34; | grep -v \u0026#34;hg18\\|hg19\\|Geuvadis_eQTL_target_gene\u0026#34; | sed -n 5,\u0026#34;$\u0026#34;p | tr \u0026#34;\\n\u0026#34; \u0026#34;\\,\u0026#34; |sed \u0026#34;s/,$//g\u0026#34;) myvcf.vcf.gz | bgzip -c \u0026gt; myvcf.dbnsfp.vcf.gz\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"effect-predictors\"\u003eEffect predictors\u003c/h2\u003e\n\u003ch3 id=\"snpeff\"\u003esnpEff\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003emodule load snpEff/snpEff_4.3t\njava -jar $SNPEFF GRCh37.75 -stats myvcf_stats.html -lof -csvStats myvcf_stats.csv myvcf.vcf.gz \u0026gt; myvcf.ann.vcf\n\u003c/code\u003e\u003c/pre\u003e","description":null,"image":null,"permalink":"https://jeancarlor.github.io/blog/modelo/","title":"Retirada"},{"content":"\u003chtml\u003e\r\n\u003chead\u003e\r\n  \u003clink rel=\"stylesheet\" type=\"text/css\" href=\"/asciinema-player.css\" /\u003e\r\n  \u003cstyle\u003e\r\n      /* .container{position: relative; width: 200px; height: 100px;} */\r\n      .frame{position: absolute; background-color: green; width: 890px; height: 300px;}\r\n      .content{margin: 18px; padding: 12px; background-color: white;}\r\n   \u003c/style\u003e\r\n\u003c/head\u003e\r\n\u003cbody\u003e\r\n  \u003cdiv id=\"demo\"\u003e\u003c/div\u003e\r\n  \u003cscript src=\"/asciinema-player.min.js\"\u003e\u003c/script\u003e\r\n  \u003c!-- \u003cscript\u003e\r\n    AsciinemaPlayer.create('/demo.cast', document.getElementById('demo'));\r\n  \u003c/script\u003e --\u003e\r\n  \u003c!-- \u003cscript async id=\"asciicast-c1sr2y3FqmfvFMDSD4WdymZve\" src=\"https://asciinema.org/a/c1sr2y3FqmfvFMDSD4WdymZve.js\"\u003c/script\u003e --\u003e\r\n\u003cdiv class=\"container\"\u003e\r\n      \u003cdiv class=\"frame\"\u003e\r\n           \u003cscript async id=\"asciicast-c1sr2y3FqmfvFMDSD4WdymZve\" src=\"https://asciinema.org/a/c1sr2y3FqmfvFMDSD4WdymZve.js\"\u003c/script\u003e\r\n      \u003c/div\u003e\r\n\u003c/div\u003e\r\n\u003c!-- \u003ca href=\"https://asciinema.org/a/14?autoplay=1\"\u003e\u003cimg src=\"https://asciinema.org/a/14.png\" width=\"836\"/\u003e\u003c/a\u003e --\u003e\r\n\u003c/body\u003e\r\n\u003c/html\u003e\r\n","description":null,"image":null,"permalink":"https://jeancarlor.github.io/policy/","title":"Privacy Policy"}]